<!DOCTYPE html>
<meta charset="utf-8">
<style>

body {
	font: 10px sans-serif;
}

.axis path,
.axis line {
	fill: none;
	stroke: #000;
	shape-rendering: crispEdges;
}

.bar {
	fill: steelblue;
}

.x.axis path {
	display: none;
}
</style>
<body>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script>

var width = 670,
		height = 350;

var strany = {"obcane_cz":0, "liberalove_cz":0, "VV":0, "konzerv_strana":0, "KSCM":0, "koruna_ceska":0, "CSNS":0, "CSSD":0, "narodni_prosperita":0, "sdruzeni_pro_rep":0, "moravane":0, "SPOZ":0, "STOP":0, "TOP09":0, "evropsky_stred":0, "KDU-CSL":0, "cibulka":0, "CS_narod_socialisticka":0, "zeleni":0, "suverenita_bobo":0, "humanisticka_str":0, "pirati":0, "DSSS":0, "svobodni":0, "ODS":0, "klicove_hnuti":0};    

var svg = d3.select("body").append("svg")
		.attr("width", width)
		.attr("height", height);

var  celkem = 0

 var yscale = d3.scale.linear()
	.domain([0, 100])
	.range([0, height]);

 var svg = d3.select("body").append("svg")
	.attr("width", width )
	.attr("height", height);

d3.csv("volby10.csv", function(error, volby) {
	var secist = volby.filter(function(e){return e.crimeRate > 0.02});

	var soucty = (secist.reduce(function(s,e){
		for (i in s){
			s[i] += e[i]*1.0;
		}
		return s;
	},strany));


	for (i in soucty){
		celkem += soucty[i] 
		soucty[i] = soucty[i]/celkem
	}

	console.log(soucty)
	console.log(celkem)

	var cibopole = [];
	for (var k in soucty) {
		console.log(k)
	cibopole.push(soucty[k]*40)
	}

	svg.selectAll(".bar")
			.data(cibopole)
			.enter().append("rect")
			.attr("class", "bar")
			.attr("x", function(d, i) { return i * 10; })
			.attr("width", "10px")
			.attr("y", "0px")
			.attr("height", function(d) { return yscale(d); });
});

</script>